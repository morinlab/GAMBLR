<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GAMBLR: Fancy Plotting Functions • GAMBLR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GAMBLR: Fancy Plotting Functions">
<meta property="og:description" content="GAMBLR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMBLR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9500</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-memo-circle-info"></span>
     
    How To
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../path_once_integrated_on_github">Install</a>
    </li>
    <li>
      <a href="../path_once_integrated_on_github">Run Remote On A Local Machine</a>
    </li>
    <li>
      <a href="../path_once_integrated_on_github">Contribute</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-person-chalkboard"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ssm_tutorial.html">SSM</a>
    </li>
    <li>
      <a href="../articles/cn_sv_tutorial.html">CN &amp; SV</a>
    </li>
    <li>
      <a href="../articles/fancy_plots.html">Fancy Plots</a>
    </li>
    <li>
      <a href="../articles/utiliteis_tutorial.html">Utilities</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions &amp; Bundled Data
  </a>
</li>
<li>
  <a href="https://github.com/morinlab/GAMBLR">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GAMBLR: Fancy Plotting Functions</h1>
                        <h4 data-toc-skip class="author">Adam Mattsson</h4>
            
            <h4 data-toc-skip class="date">July 07, 2022</h4>
      
      
      <div class="hidden name"><code>fancy_plots.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="plotting-parameters-global-variables-and-packages-">Plotting Parameters, Global Variables and Packages.<a class="anchor" aria-label="anchor" href="#plotting-parameters-global-variables-and-packages-"></a>
</h2>
<p>Define global plotting parameters, load packages etc.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GAMBLR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/G3viz/g3viz" class="external-link">g3viz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PoisonAlien/maftools" class="external-link">maftools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/ssh/" class="external-link">ssh</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#set sample to be plotted</span></span>
<span><span class="va">this_sample</span> <span class="op">=</span> <span class="st">"HTMCP-01-06-00422-01A-01D"</span></span>
<span></span>
<span><span class="co">#retrieve maf for selected sample</span></span>
<span><span class="va">maf</span> <span class="op">=</span> <span class="fu"><a href="../reference/assign_cn_to_ssm.html">assign_cn_to_ssm</a></span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="va">this_sample</span>,</span>
<span>                       coding_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       from_flatfile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       use_augmented_maf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">maf</span></span>
<span></span>
<span><span class="co">#get seq data</span></span>
<span><span class="va">seq</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_sample_cn_segments.html">get_sample_cn_segments</a></span><span class="op">(</span>this_sample <span class="op">=</span> <span class="va">this_sample</span>,</span>
<span>                             multiple_samples <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             streamlined <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             from_flatfile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#get gambl metadata</span></span>
<span><span class="va">this_meta</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_gambl_metadata.html">get_gambl_metadata</a></span><span class="op">(</span>seq_type_filter <span class="op">=</span> <span class="st">"genome"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#subset on all FL cases</span></span>
<span><span class="va">all_fl</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">this_meta</span>, <span class="va">pathology</span> <span class="op">==</span> <span class="st">"FL"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#subset on FL cases we have QC data for</span></span>
<span><span class="va">sub_fl</span> <span class="op">=</span> <span class="va">all_fl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">128</span><span class="op">:</span><span class="fl">183</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">sub_fl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sub_fl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sub_fl</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"sample_id"</span></span>
<span></span>
<span><span class="co">#subset on all BL cases</span></span>
<span><span class="va">all_bl</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">this_meta</span>, <span class="va">pathology</span> <span class="op">==</span> <span class="st">"BL"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#get sample IDs for all available gambl samples</span></span>
<span><span class="va">all_samples</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">this_meta</span>, <span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sample-level-plotting">Sample-Level Plotting<a class="anchor" aria-label="anchor" href="#sample-level-plotting"></a>
</h2>
<p>This vignette explores newly added plotting functions in GAMBLR, directed towards sample-level visualization. These functions are intended to provide a quick and comprehensive overview related to Structural Variants (SV), Copy Number Variation (CNV), Loss Of Heterozygosity (LOH) and intersection of relevant genes/regions. These function follows the following nomenclature <code>fancy_xplot</code>. For more info, see usage examples and parameter descriptions, please view the documentation of GAMBLR.</p>
<div class="section level3">
<h3 id="variant-overview">Variant Overview<a class="anchor" aria-label="anchor" href="#variant-overview"></a>
</h3>
<div class="section level4">
<h4 id="variant-counts">Variant Counts<a class="anchor" aria-label="anchor" href="#variant-counts"></a>
</h4>
<p>Interested in how many variants are present in a given sample? A quick way to overview such information would be to call <code>fancy_svbar</code> on a given sample ID. This function returns a bar plot visualizing SVs or SSMs. A variety of sub-setting options are also available. Such as chromosome selection and variant types to be included in plot. In the example bellow, we’re looking at genome-wide SSMs for one selected sample.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fancy_v_count.html">fancy_v_count</a></span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="va">this_sample</span>,</span>
<span>              maf_data <span class="op">=</span> <span class="va">maf</span>,</span>
<span>              ssm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              variant_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DEL"</span>, <span class="st">"DNP"</span>, <span class="st">"INS"</span>, <span class="st">"SNP"</span><span class="op">)</span>, </span>
<span>              log10_y <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>              snp_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNP"</span> <span class="op">=</span> <span class="st">"#2B9971"</span>, <span class="st">"DNP"</span> <span class="op">=</span> <span class="st">"#993F2B"</span><span class="op">)</span>,</span>
<span>              from_flatfile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              use_augmented_maf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              plot_subtitle <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>              plot_title <span class="op">=</span> <span class="st">"SSM Count Example"</span>,</span>
<span>              chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              coding_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="fancy_plots_files/figure-html/svbar-1.png" width="1093.75"></p>
</div>
<div class="section level4">
<h4 id="variant-counts-per-chromosome-">Variant Counts Per Chromosome.<a class="anchor" aria-label="anchor" href="#variant-counts-per-chromosome-"></a>
</h4>
<p>Sometimes it can be useful to overview variant distributions (SSM or SVs) across the complete genomic landscape. To do so, one could call <code>fancy_v_chrcount</code> with sample ID. Optional arguments for sub-setting your data are available (see parameter descriptions for more information). In the following example we’re plotting SV (ssm = FALSE) counts for autosomes. One can also call <code>add_qc_metric</code> to add a second y-axis annotating mean corrected coverage for the selected sample.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fancy_v_chrcount.html">fancy_v_chrcount</a></span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="st">"HTMCP-01-06-00422-01A-01D"</span>,</span>
<span>                 plot_subtitle <span class="op">=</span>  <span class="st">"grch37"</span>,</span>
<span>                 plot_title <span class="op">=</span> <span class="st">"SV Genomic Distribution Example"</span>,</span>
<span>                 ssm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 projection <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>                 min_vaf <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                 chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 coding_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 from_flatfile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 use_augmented_maf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="fancy_plots_files/figure-html/svdist-1.png" width="1093.75"></p>
</div>
<div class="section level4">
<h4 id="variant-size-distributions">Variant Size Distributions<a class="anchor" aria-label="anchor" href="#variant-size-distributions"></a>
</h4>
<p>A useful way to visualize variant size distributions is to call <code>fancy_v_sizedis</code> to generate a violin plot showing variant size distributions (sample-level) across selected contigs (per default chr1-22). Optional parameters to sub-set data to include only coding regions are also available for this function, as well as to plot SVs by setting <code>ssm = FALSE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fancy_v_sizedis.html">fancy_v_sizedis</a></span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="va">this_sample</span>,</span>
<span>                maf_data <span class="op">=</span> <span class="va">maf</span>,</span>
<span>                plot_title <span class="op">=</span> <span class="st">"SV (small variants) Size Distribution Example"</span>,</span>
<span>                ssm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                scale_value <span class="op">=</span> <span class="st">"width"</span>,</span>
<span>                plot_trim <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                log_10 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                plot_subtitle <span class="op">=</span>  <span class="st">"grch37"</span>,</span>
<span>                chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                from_flatfile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                use_augmented_maf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                coding_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="fancy_plots_files/figure-html/svvplot-1.png" width="1093.75"></p>
</div>
<div class="section level4">
<h4 id="structural-variant-size-densities-">Structural Variant Size Densities.<a class="anchor" aria-label="anchor" href="#structural-variant-size-densities-"></a>
</h4>
<p>Another useful plotting function for visualizing SV size distributions is <code>fancy_sv_sizedens</code>. In this example, we’re showing SVs (larger 50bp and with a with minimum vaf of 0) size distributions for a specific sample and selected chromosomes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fancy_sv_sizedens.html">fancy_sv_sizedens</a></span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="va">this_sample</span>,</span>
<span>                  vaf_cutoff <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                  size_cutoff <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                  chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  plot_title <span class="op">=</span> <span class="st">"SV (&gt;50bp) Size Distribution Example"</span>,</span>
<span>                  plot_subtitle <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>                  projection <span class="op">=</span> <span class="st">"grch37"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fancy_plots_files/figure-html/sv_size-1.png" width="1093.75"></p>
</div>
</div>
<div class="section level3">
<h3 id="single-nucleotide-variants-chromosome-distributions-">Single Nucleotide Variants Chromosome Distributions.<a class="anchor" aria-label="anchor" href="#single-nucleotide-variants-chromosome-distributions-"></a>
</h3>
<p>Curious to see how SNVs are distributed across specific chromosomes? For this purpose <code>fancy_snv_chrdistplot</code> was developed. This function takes a sample ID and retrieves SNV information (using <code>assign_cn_to_ssm</code>) and plots variants in an ideogram dependent manner. Similarly to other <code>fanxy_x_plot</code> functions, a selection of parameters are available for data sub-setting and plot customization. For example, by calling the include_dnp, DNP counts will be added to each bar.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fancy_snv_chrdistplot.html">fancy_snv_chrdistplot</a></span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="va">this_sample</span>,</span>
<span>                      maf_data <span class="op">=</span> <span class="va">maf</span>,</span>
<span>                      plot_subtitle <span class="op">=</span> <span class="st">"SNV Distribution Example"</span>,</span>
<span>                      plot_title <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>                      chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      include_dnp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      from_flatfile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      use_augmented_maf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      coding_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="fancy_plots_files/figure-html/snvbar-1.png" width="1093.75"></p>
</div>
<div class="section level3">
<h3 id="copy-number-states-summaries-">Copy Number States Summaries.<a class="anchor" aria-label="anchor" href="#copy-number-states-summaries-"></a>
</h3>
<p>A useful way to visualize copy number information is with the the <code>fancy_cnvbar</code>. This function takes one required parameter (sample ID), calls <code>get_cn_segments</code> and <code>assign_cn_ssm</code> to retrieve data for plotting. The plot highlights the number of CN states for any given sample (left y-axis), together with n bases included in each given CN state (right y-axis).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fancy_cnbar.html">fancy_cnbar</a></span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="va">this_sample</span>,</span>
<span>            seq_data <span class="op">=</span> <span class="va">seq</span>,</span>
<span>            plot_title <span class="op">=</span> <span class="st">"CNV Barplot Example"</span>,</span>
<span>            plot_subtitle <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>            chr_select <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            include_cn2 <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="fancy_plots_files/figure-html/cnbar-1.png" width="1093.75"></p>
</div>
</div>
<div class="section level2">
<h2 id="ideograms">Ideograms<a class="anchor" aria-label="anchor" href="#ideograms"></a>
</h2>
<p>This section explores ideogram plotting functions available withing GAMBLR. Functions are available for both sample-level, as well as on a multi-sample level.</p>
<div class="section level3">
<h3 id="sample-level-ideograms-">Sample-level Ideograms.<a class="anchor" aria-label="anchor" href="#sample-level-ideograms-"></a>
</h3>
<p>A great way to overview SVs and Copy Number Segments on sample-level is to call <code>fancy_ideogram</code>. This function creates an ideogram based on the chromosomes defined in the <code>chr_select</code> parameter. Copy Number states are plotted along the x-axis (selected contigs plotted vertically on the y-axis). The plot annotates Copy Number States from 0 to 6+. Additional support for superimposing SVs on the ideogram is also possible, by setting <code>include_sv</code> to TRUE, deletions and insertions will be plotted as lollipops. n Number of SVs can also be added for each contig. This is achieved by specifying <code>sv_count</code> to TRUE. In addition, it’s also possible to highlight genomic regions fo interest, such as genes, hotspots, difficult to map regions, etc. For convenience, one can specify a list of genes under the <code>gene_annotation</code> parameter. The function will then implement <code>gene_to_region</code> function to convert gene names to bed-style coordinates.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fancy_ideogram.html">fancy_ideogram</a></span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="va">this_sample</span>,</span>
<span>               gene_annotation <span class="op">=</span> <span class="st">"MYC"</span>,</span>
<span>               plot_title <span class="op">=</span> <span class="st">"Sample-level Ideogram Example"</span>,</span>
<span>               plot_subtitle <span class="op">=</span> <span class="st">"grch37"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fancy_plots_files/figure-html/fancy_ideogram-1.png" width="2100"></p>
</div>
<div class="section level3">
<h3 id="multi-sample-ideograms">Multi-sample Ideograms<a class="anchor" aria-label="anchor" href="#multi-sample-ideograms"></a>
</h3>
<p>It’s also possible to plot multiple samples (2, 3 or 4) in a similar manner. This can be used to infer inheritance patterns, hotspots, etc. across multiple samples. For this purpose <code>fancy_ideogram_multisamp</code> was developed. This function is called with similar parameters as <code>fancy_ideogram</code> with the addition that <code>this_sample</code> has been replaced with <code>these_sample_ids</code>. The function automatically detects the number of samples provided and sets the plotting parameters accordingly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#load two samples</span></span>
<span><span class="va">two_samples</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"00-15201_tumorA"</span>, <span class="st">"00-15201_tumorB"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#build plot</span></span>
<span><span class="fu"><a href="../reference/fancy_multisamp_ideogram.html">fancy_multisamp_ideogram</a></span><span class="op">(</span>these_sample_ids <span class="op">=</span> <span class="va">two_samples</span>, </span>
<span>                         include_cn2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         plot_title <span class="op">=</span> <span class="st">"Multi-sample Ideograms Example."</span>,</span>
<span>                         plot_sub <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>                         chr_anno_dist <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>                         chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="fancy_plots_files/figure-html/fancy_ideogram_multisamp-1.png" width="2100"></p>
</div>
</div>
<div class="section level2">
<h2 id="quality-control-metric-visualization-sample-subset-and-comparison-groups-">Quality Control Metric Visualization, Sample Subset and Comparison Groups.<a class="anchor" aria-label="anchor" href="#quality-control-metric-visualization-sample-subset-and-comparison-groups-"></a>
</h2>
<p>This section explores different ways to visualize QC metrics. All functions in this section calls <code>collate_qc_result</code> to retrieve metrics for the selected samples.</p>
<div class="section level3">
<h3 id="alignment-metrics-summaries-">Alignment Metrics Summaries.<a class="anchor" aria-label="anchor" href="#alignment-metrics-summaries-"></a>
</h3>
<p>This function takes a list of sample IDs and gathers relevant metrics (alignment) to be plotted. Alternatively, if no df with sample IDs is provided, the function internally calls <code>get_gambl_metadata</code> to get sample IDs. The function also has convenience parameters allowing for easy subset to a specific pathology/cohort. In addition, the function also takes a df with comparison samples (sample IDs) allowing for an easy and straight-forward comparison between selected samples vs any other subset of samples. In this example, we are plotting alignment metrics for all FL samples in the scope of all BL cases.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#build plot</span></span>
<span><span class="fu"><a href="../reference/fancy_alignment_plot.html">fancy_alignment_plot</a></span><span class="op">(</span>these_sample_ids <span class="op">=</span> <span class="va">sub_fl</span>,</span>
<span>                     comparison_group <span class="op">=</span> <span class="va">all_bl</span>,</span>
<span>                     add_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     seq_type <span class="op">=</span> <span class="st">"genome"</span>,</span>
<span>                     plot_sub <span class="op">=</span> <span class="st">"all FL cases (BL comparison group)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span></span>
<span><span class="co">## /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span></span></code></pre>
<p><img src="fancy_plots_files/figure-html/fancy_alignment_plot-1.png" width="2700"></p>
</div>
<div class="section level3">
<h3 id="flexible-quality-control-metric-plots-">Flexible Quality Control Metric Plots.<a class="anchor" aria-label="anchor" href="#flexible-quality-control-metric-plots-"></a>
</h3>
<p>If you are interested in exploring the distribution of a specific QC metric for a set number of sample IDs, <code>fancy_qc_plot</code> is the way to go. This function lets the user specify what metric they want to plot across different sample subsets, flexible comparison group options, as well as grouping the plot by a factor of choice. Unsure what metrics are available for plotting? Just call the function with <code>return_plotdata = TRUE</code> and a list of available metrics will be returned (and nothing else). In this example we are looking at Average Base Quality for FL samples in the “Kridel” cohort, compared to BL samples in the BL pediatric cohort. Each bar in the shown plot represent an individual sample from the defined pathology/cohort, dotted hline is annotating the mean value for selected sample and the solid hline is describing the mean value for the selected comparison group.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#return available metrics for plotting</span></span>
<span><span class="fu"><a href="../reference/fancy_qc_plot.html">fancy_qc_plot</a></span><span class="op">(</span>return_plotdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "AverageBaseQuality"        "AverageInsertSize"        </span></span>
<span><span class="co">##  [3] "AverageReadLength"         "PairsOnDiffCHR"           </span></span>
<span><span class="co">##  [5] "TotalReads"                "TotalUniquelyMapped"      </span></span>
<span><span class="co">##  [7] "TotalUnmappedreads"        "TotalDuplicatedreads"     </span></span>
<span><span class="co">##  [9] "ProportionReadsDuplicated" "ProportionReadsMapped"    </span></span>
<span><span class="co">## [11] "MeanCorrectedCoverage"     "ProportionCoverage10x"    </span></span>
<span><span class="co">## [13] "ProportionCoverage30x"</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#subset a comparison group</span></span>
<span><span class="va">bl_metadata</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_gambl_metadata.html">get_gambl_metadata</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span> <span class="op">==</span> <span class="st">"BL"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#build plot</span></span>
<span><span class="fu"><a href="../reference/fancy_qc_plot.html">fancy_qc_plot</a></span><span class="op">(</span>keep_pathology <span class="op">=</span> <span class="st">"FL"</span>, <span class="co">#pathology filtering criteria for samples to be plotted</span></span>
<span>              keep_cohort <span class="op">=</span> <span class="st">"FL_Kridel"</span>, <span class="co">#cohort filtering option, filters samples with FL pathology on the selected cohort.</span></span>
<span>              comparison_samples <span class="op">=</span> <span class="va">bl_metadata</span>, <span class="co">#comparison group</span></span>
<span>              plot_data <span class="op">=</span> <span class="st">"AverageBaseQuality"</span>, <span class="co">#metric to be plotted.</span></span>
<span>              fill_by <span class="op">=</span> <span class="st">"pathology"</span>, <span class="co">#fill value.</span></span>
<span>              plot_title <span class="op">=</span> <span class="st">"Average Base Quality"</span>, <span class="co">#plot title.</span></span>
<span>              y_axis_lab <span class="op">=</span> <span class="st">"Base Quality"</span>, <span class="co">#y-axis label.</span></span>
<span>              seq_type <span class="op">=</span> <span class="st">"genome"</span><span class="op">)</span> <span class="co">#seq_type for retrieved data.</span></span></code></pre></div>
<pre><code><span><span class="co">## /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span></span>
<span><span class="co">## /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span></span></code></pre>
<p><img src="fancy_plots_files/figure-html/fancy_qc_plot-1.png" width="1093.75"></p>
</div>
<div class="section level3">
<h3 id="coverage-summary-plots-">Coverage Summary Plots.<a class="anchor" aria-label="anchor" href="#coverage-summary-plots-"></a>
</h3>
<p>Curious to see what fractions of a specific subset of samples have at least 10X and 30X coverage? For this purpose <code>fancy_propcov_plot</code> was developed. This function outputs a violin plot annotating the percentages of selected samples that have at least 10X and 30X coverage. The plot also allows for a straightforward comparison with another subset of samples. This allows the user to quickly interrogate how the coverage of a set number of samples (from different cohort/pathology) compares to another group of samples. In this example, we’re once again looking at how the coverage compares for all FL cases vs all gambl samples.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#build plot</span></span>
<span><span class="fu"><a href="../reference/fancy_propcov_plot.html">fancy_propcov_plot</a></span><span class="op">(</span>these_sample_ids <span class="op">=</span> <span class="va">sub_fl</span>,</span>
<span>                   comparison_samples <span class="op">=</span> <span class="va">all_samples</span>,</span>
<span>                   seq_type <span class="op">=</span> <span class="st">"genome"</span>,</span>
<span>                   plot_subtitle <span class="op">=</span> <span class="st">"Proportional coverage FL samples compared to all gambl samples"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span></span></code></pre>
<p><img src="fancy_plots_files/figure-html/fancy_propcov_plot-1.png" width="1093.75"></p>
</div>
<div class="section level3">
<h3 id="proportional-metrics-">Proportional Metrics.<a class="anchor" aria-label="anchor" href="#proportional-metrics-"></a>
</h3>
<p>Another way to inspect proportional QC metrics is by calling <code>fancy_proportions_plot</code>. This function gathers all proportional QC metrics and plots them in a grouped bar plot (similarly to <code>fancy_alignment_plot</code>). These metrics include <code>duplicated reads</code>, <code>mapped reads</code>, <code>=&gt;10X coverage reads</code>, and <code>=&gt;30X coverage reads</code>. In this example we are looking at FL samples from the Kridel cohort. This function also annotates the mean values for the plotted metrics.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kridel_fl</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_gambl_metadata.html">get_gambl_metadata</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span> <span class="op">==</span> <span class="st">"FL"</span>, <span class="va">cohort</span> <span class="op">==</span> <span class="st">"FL_Kridel"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample_id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/fancy_propcov_plot.html">fancy_propcov_plot</a></span><span class="op">(</span>these_sample_ids <span class="op">=</span> <span class="va">kridel_fl</span>, seq_type <span class="op">=</span> <span class="st">"genome"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span></span></code></pre>
<p><img src="fancy_plots_files/figure-html/fancy_proportions_plot-1.png" width="2700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ryan Morin, Kostia Dreval, Adam Mattsson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
