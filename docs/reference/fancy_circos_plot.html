<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>SSM and SV Circos Plot. — fancy_circos_plot • GAMBLR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="SSM and SV Circos Plot. — fancy_circos_plot"><meta property="og:description" content="Create a circos plot visualizing SVS and SSM with optional gene annotations."><meta property="og:image" content="https://github.com/morinlab/GAMBLR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMBLR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9500</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-memo-circle-info"></span>
     
    How To
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://morinlab.github.io/GAMBLR/#installation" class="external-link">Install</a>
    </li>
    <li>
      <a href="https://morinlab.github.io/GAMBLR/#running-gamblr-on-your-own-computer" class="external-link">Running GAMBLR On Your Own Computer</a>
    </li>
    <li>
      <a href="https://morinlab.github.io/GAMBLR/#contributing" class="external-link">Contribute</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-person-chalkboard"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ssm_tutorial.html">SSM</a>
    </li>
    <li>
      <a href="../articles/cn_sv_tutorial.html">CN &amp; SV</a>
    </li>
    <li>
      <a href="../articles/fancy_plots.html">Fancy Plots</a>
    </li>
    <li>
      <a href="../articles/utilities_tutorial.html">Utilities</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions &amp; Bundled Data
  </a>
</li>
<li>
  <a href="https://github.com/morinlab/GAMBLR">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SSM and SV Circos Plot.</h1>
    
    <div class="hidden name"><code>fancy_circos_plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a circos plot visualizing SVS and SSM with optional gene annotations.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fancy_circos_plot</span><span class="op">(</span></span>
<span>  <span class="va">this_sample_id</span>,</span>
<span>  <span class="va">gene_list</span>,</span>
<span>  ssm_calls <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sv_calls <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  vaf_cutoff <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  coding_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  from_flatfile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_augmented_maf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  projection <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>  this_seq_type <span class="op">=</span> <span class="st">"genome"</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">this_sample_id</span><span class="op">)</span>,</span>
<span>  <span class="va">out</span>,</span>
<span>  pdf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">this_sample_id</span>, <span class="st">"_circos.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>this_sample_id</dt>
<dd><p>Sample to be plotted.</p></dd>


<dt>gene_list</dt>
<dd><p>Optional parameter to annotate genes on the circos plot from a data frame of genes. Is compatible with <a href="gene_to_region.html">gene_to_region</a> (return_as = "bed") output format. See examples.</p></dd>


<dt>ssm_calls</dt>
<dd><p>Boolean parameter for plotting ssm. Default is TRUE.</p></dd>


<dt>sv_calls</dt>
<dd><p>Boolean parameter for plotting SVs, default is TRUE.</p></dd>


<dt>chr_select</dt>
<dd><p>Optional argument for subset on selected chromosomes, default is all autosomes.</p></dd>


<dt>vaf_cutoff</dt>
<dd><p>Threshold for filtering variants on VAF (events with a VAF &gt; cutoff will be retained).</p></dd>


<dt>coding_only</dt>
<dd><p>Optional. Set to TRUE to restrict to plotting only coding mutations.</p></dd>


<dt>from_flatfile</dt>
<dd><p>If set to TRUE the function will use flat files instead of the database.</p></dd>


<dt>use_augmented_maf</dt>
<dd><p>Boolean statement if to use augmented maf, default is TRUE.</p></dd>


<dt>projection</dt>
<dd><p>Genomic projection for variants and circos plot. Accepted values are grch37 and hg38, default is grch37.</p></dd>


<dt>this_seq_type</dt>
<dd><p>Seq type for returned CN segments. One of "genome" (default) or "capture".</p></dd>


<dt>plot_title</dt>
<dd><p>Optional parameter for naming your plot, default is this_sample.</p></dd>


<dt>out</dt>
<dd><p>Path to output folder, to where the plot will be exported.</p></dd>


<dt>pdf</dt>
<dd><p>Set to FALSE for png, default is TRUE (pdf).</p></dd>


<dt>file_name</dt>
<dd><p>Optional parameter for specifying the file name of generated circos plot, default is "this_sample_circos.pdf". If pdf is set to FALSE, a png will be generated, thus the .png extension needs to be attached to the file_name.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Nothing.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is using RCircos to create sample-level cirocs plots, annotating SVs and SSM with the potential of adding gene annotations.
To control what variants are to be plotted, simply use the two Boolean parameters; <code>ssm_calls</code> and <code>sv_calls</code> (both TRUE by default).
Provide the sample ID of interest in with the <code>this_sample_id</code> parameter. This function calls <a href="assign_cn_to_ssm.html">assign_cn_to_ssm</a> and <a href="get_combined_sv.html">get_combined_sv</a> to retrieve data for plotting.
Since this function does not create a grob, but rather outputs a rendered PDF/PNG, the user has to provide an output path with the <code>out</code> parameter.
In addition, the user can control the output format. For PDF, set <code>pdf</code> to TRUE (default) and to export the created plot as PNG, set the same parameter to FALSE.
This function also has convenient filtering parameters available, see parameter descriptions for more information and how to properly use the filtering parameters.
Lastly, this plot can also highlight genes of interest. To do so, provide a data frame (comparable to the return from <code>gene_to_region(return_as = "bed")</code>) to the <code>gene_list</code> parameter.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#retrieve gene names for FL genes</span></span></span>
<span class="r-in"><span><span class="va">fl_genes</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">GAMBLR.data</span><span class="fu">::</span><span class="va">lymphoma_genes_lymphoma_genes_v0.0</span>, <span class="va">FL</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span>  <span class="fu">pull</span><span class="op">(</span><span class="va">Gene</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get regions for selected genes</span></span></span>
<span class="r-in"><span><span class="va">fl_genes_list</span> <span class="op">=</span> <span class="fu"><a href="gene_to_region.html">gene_to_region</a></span><span class="op">(</span>gene_symbol <span class="op">=</span> <span class="va">fl_genes</span>,</span></span>
<span class="r-in"><span>                               return_as <span class="op">=</span> <span class="st">"bed"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fancy_circos_plot</span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="st">"DOHH-2"</span>,</span></span>
<span class="r-in"><span>                  ssm_calls <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                  gene_list <span class="op">=</span> <span class="va">fl_genes_list</span>,</span></span>
<span class="r-in"><span>                  chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr8"</span>,</span></span>
<span class="r-in"><span>                                 <span class="st">"chr14"</span>,</span></span>
<span class="r-in"><span>                                 <span class="st">"chr18"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  out <span class="op">=</span> <span class="st">"../../plots/"</span>,</span></span>
<span class="r-in"><span>                  plot_title <span class="op">=</span> <span class="st">"DOHH-2 (SVs) Example Plot"</span>,</span></span>
<span class="r-in"><span>                  pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                  file_name <span class="op">=</span> <span class="st">"dohh2_example.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ryan Morin, Kostia Dreval, Adam Mattsson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

