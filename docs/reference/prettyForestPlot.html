<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Forest Plot. — prettyForestPlot • GAMBLR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Forest Plot. — prettyForestPlot"><meta property="og:description" content="Create a forest plot comparing mutation frequencies for a set of genes between two groups."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMBLR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9500</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-memo-circle-info"></span>
     
    How To
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../path_once_integrated_on_github">Install</a>
    </li>
    <li>
      <a href="../path_once_integrated_on_github">Run Remote On A Local Machine</a>
    </li>
    <li>
      <a href="../path_once_integrated_on_github">Contribute</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-person-chalkboard"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ssm_tutorial.html">SSM</a>
    </li>
    <li>
      <a href="../articles/cn_sv_tutorial.html">CN &amp; SV</a>
    </li>
    <li>
      <a href="../articles/fancy_plots.html">Fancy Plots</a>
    </li>
    <li>
      <a href="../articles/utiliteis_tutorial.html">Utilities</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions &amp; Bundled Data
  </a>
</li>
<li>
  <a href="https://github.com/morinlab/GAMBLR">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Forest Plot.</h1>
    
    <div class="hidden name"><code>prettyForestPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a forest plot comparing mutation frequencies for a set of genes between two groups.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prettyForestPlot</span><span class="op">(</span></span>
<span>  <span class="va">maf</span>,</span>
<span>  <span class="va">mutmat</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  <span class="va">genes</span>,</span>
<span>  min_mutations <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">comparison_column</span>,</span>
<span>  rm_na_samples <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  comparison_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  separate_hotspots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  comparison_name <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  custom_colours <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  custom_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_q <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>maf</dt>
<dd><p>A maf data frame. Minimum required columns are Hugo_Symbol and Tumor_Sample_Barcode.</p></dd>


<dt>mutmat</dt>
<dd><p>Optional argument for binary mutation matrix. If not supplied, function will generate this matrix from the file used in argument "maf".</p></dd>


<dt>metadata</dt>
<dd><p>Metadata for the comparisons. Minimum required columns are Tumor_Sample_Barcode and the column assigning each case to one of two groups.</p></dd>


<dt>genes</dt>
<dd><p>An optional vector of genes to restrict your plot to. If no gene-list is supplied, the function will extract all mutated genes from the incoming maf. See min_mutations parameter for more info.</p></dd>


<dt>min_mutations</dt>
<dd><p>Optional parameter for when no <code>genes</code> is provided. This parameter ensures only genes with n mutations are kept in <code>genes</code>. Default value is 1, this means all genes in the incoming maf will be plotted.</p></dd>


<dt>comparison_column</dt>
<dd><p>Mandatory: the name of the metadata column containing the comparison values.</p></dd>


<dt>rm_na_samples</dt>
<dd><p>Set to TRUE to remove 0 mutation samples. Default is FALSE.</p></dd>


<dt>comparison_values</dt>
<dd><p>Optional: If the comparison column contains more than two values or is not a factor, specify a character vector of length two in the order you would like the factor levels to be set, reference group first.</p></dd>


<dt>separate_hotspots</dt>
<dd><p>Optional: If you would like to treat hotspots separately from other mutations in any gene. Requires that the maf file is annotated with <a href="annotate_hotspots.html">annotate_hotspots</a>.</p></dd>


<dt>comparison_name</dt>
<dd><p>Optional: Specify the legend title if different from the comparison column name.</p></dd>


<dt>custom_colours</dt>
<dd><p>Optional: Specify a named vector of colours that match the values in the comparison column.</p></dd>


<dt>custom_labels</dt>
<dd><p>Optional: Specify custom labels for the legend categories. Must be in the same order as comparison_values.</p></dd>


<dt>max_q</dt>
<dd><p>cut off for q values to be filtered in fish test</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A convenient list containing all the data frames that were created in making the plot, including the mutation matrix. It also produces (and returns) ggplot object with a side-by-side forest plot and bar plot showing mutation incidences across two groups.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function returns two types of plot (box plot and forest plot), the user can either view them separately or arranged on the same grob.
In addition this function also lets the user control the mutation frequencies of the plotted genes.
If no <code>genes</code> is provided, this function auto-defaults to all genes in the incoming maf.
The user can then control the minimum number of mutations requirement for a gene to be included in the plot.
This is done with the <code>min_mutations</code> parameter.
For extended examples on how to use this function, refer to the example inside the function documentation or the vignettes.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">metadata</span> <span class="op">=</span> <span class="fu"><a href="get_gambl_metadata.html">get_gambl_metadata</a></span><span class="op">(</span>case_set <span class="op">=</span> <span class="st">"tFL-study"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining, by = "sample_id"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining, by = "sample_id"</span>
<span class="r-in"><span><span class="va">this_meta</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">metadata</span>, <span class="va">pairing_status</span> <span class="op">==</span> <span class="st">"matched"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">this_meta</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">this_meta</span>, <span class="va">consensus_pathology</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FL"</span>, <span class="st">"DLBCL"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">maf</span> <span class="op">=</span> <span class="fu"><a href="get_coding_ssm.html">get_coding_ssm</a></span><span class="op">(</span>limit_samples <span class="op">=</span> <span class="va">this_metadata</span><span class="op">$</span><span class="va">sample_id</span>,</span></span>
<span class="r-in"><span>                     basic_columns <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                     seq_type <span class="op">=</span> <span class="st">"genome"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in dplyr::filter(., sample_id %in% limit_samples):</span> Problem while computing `..1 = sample_id %in% limit_samples`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error in `h()`:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> error in evaluating the argument 'table' in selecting a method for function '%in%': object 'this_metadata' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">prettyForestPlot</span><span class="op">(</span>maf <span class="op">=</span> <span class="va">maf</span>,</span></span>
<span class="r-in"><span>                 metadata <span class="op">=</span> <span class="va">this_metadata</span>,</span></span>
<span class="r-in"><span>                 genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ATP6V1B2"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"EZH2"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"TNFRSF14"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"RRAGC"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 comparison_column <span class="op">=</span> <span class="st">"consensus_pathology"</span>,</span></span>
<span class="r-in"><span>                 comparison_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DLBCL"</span>,</span></span>
<span class="r-in"><span>                                       <span class="st">"FL"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 separate_hotspots <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                 comparison_name <span class="op">=</span> <span class="st">"FL vs DLBCL"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in prettyForestPlot(maf = maf, metadata = this_metadata, genes = c("ATP6V1B2",     "EZH2", "TNFRSF14", "RRAGC"), comparison_column = "consensus_pathology",     comparison_values = c("DLBCL", "FL"), separate_hotspots = FALSE,     comparison_name = "FL vs DLBCL"):</span> object 'this_metadata' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ryan Morin, Kostia Dreval, Adam Mattsson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

