<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot Quality Control Metrics. — fancy_qc_plot • GAMBLR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Quality Control Metrics. — fancy_qc_plot"><meta property="og:description" content="Plot for visualizing QC metrics and allowing for grouping by different metadata columns."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMBLR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9500</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-memo-circle-info"></span>
     
    How To
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../path_once_integrated_on_github">Install</a>
    </li>
    <li>
      <a href="../path_once_integrated_on_github">Run Remote On A Local Machine</a>
    </li>
    <li>
      <a href="../path_once_integrated_on_github">Contribute</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-person-chalkboard"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ssm_tutorial.html">SSM</a>
    </li>
    <li>
      <a href="../articles/cn_sv_tutorial.html">CN &amp; SV</a>
    </li>
    <li>
      <a href="../articles/fancy_plots.html">Fancy Plots</a>
    </li>
    <li>
      <a href="../articles/utiliteis_tutorial.html">Utilities</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions &amp; Bundled Data
  </a>
</li>
<li>
  <a href="https://github.com/morinlab/GAMBLR">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot Quality Control Metrics.</h1>
    
    <div class="hidden name"><code>fancy_qc_plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot for visualizing QC metrics and allowing for grouping by different metadata columns.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fancy_qc_plot</span><span class="op">(</span></span>
<span>  <span class="va">these_sample_ids</span>,</span>
<span>  <span class="va">keep_cohort</span>,</span>
<span>  <span class="va">keep_pathology</span>,</span>
<span>  seq_type <span class="op">=</span> <span class="st">"genome"</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  <span class="va">these_samples_metadata</span>,</span>
<span>  <span class="va">plot_data</span>,</span>
<span>  fill_by <span class="op">=</span> <span class="st">"pathology"</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample_id"</span>, <span class="st">"cohort"</span><span class="op">)</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">comparison_samples</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="st">""</span>,</span>
<span>  y_axis_lab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  return_plotdata <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>these_sample_ids</dt>
<dd><p>Data frame with sample IDs (to be plotted) in the first column (has to be named sample_id).</p></dd>


<dt>keep_cohort</dt>
<dd><p>Optional parameter to be used when these_sample is NULL. Calls get_gambl_metadata() and filters on the cohort supplied in this parameter.</p></dd>


<dt>keep_pathology</dt>
<dd><p>Optional parameter to be used when these_sample is NULL. Calls get_gambl_metadata() and filters on the pathology supplied in this parameter.</p></dd>


<dt>seq_type</dt>
<dd><p>Selected seq type for incoming QC metrics.</p></dd>


<dt>metadata</dt>
<dd><p>Optional, user can provide a metadata df to subset sample IDs from.</p></dd>


<dt>these_samples_metadata</dt>
<dd><p>GAMBL metadata subset to the cases you want to process.</p></dd>


<dt>plot_data</dt>
<dd><p>Plotting parameter, define the data type to be plotted.</p></dd>


<dt>fill_by</dt>
<dd><p>Parameter for specifying fill variable for grouped bar plot. Can be any factor from incoming metadata, e.g pathology, cohort, etc.</p></dd>


<dt>labels</dt>
<dd><p>If HTML plot version is rendered, you can specify what labels should be visible when hovering over the dots. Default is sample id and cohort. This parameter expects a vector of charachters.</p></dd>


<dt>interactive</dt>
<dd><p>Boolean parameter for generating interactive plot (HTML). Default is FALSE.</p></dd>


<dt>comparison_samples</dt>
<dd><p>Optional parameter, give the function a vector of sample IDs to be compared against the main plotting group. Pathology is default.</p></dd>


<dt>plot_title</dt>
<dd><p>Plotting parameter, plot title.</p></dd>


<dt>y_axis_lab</dt>
<dd><p>Plotting parameter, label of y-axis.</p></dd>


<dt>return_plotdata</dt>
<dd><p>Optional parameter, if set to TRUE a vector of acceptable data types for plotting will be returned, and nothing else.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A plot as a ggplot object (grob).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is readily available for visualizing a variety of quality control metrics. To get started, the user can easily overview all the available metrics with <code>return_plotdata = TRUE</code>.
When this parameter is set to TRUE, a vector of characters will be returned detailing all the, for this plot, available metrics. After deciding what metric to plot, simply give the metric of choice to the <code>plot_data</code> parameter.
This function also lets the user provide a data frame with sample IDs to be included in the plot. Optionally, the user can also provide an already filtered metadata table with sample IDs of interest to the <code>these_samples_metadata</code>.
If none of the two parameters are supplied, the user can easily restrict the plot to any cohort and/or pathology of their liking. This is done by calling <code>keep_cohort</code> and <code>keep_pathology</code>.
If these parameters are used, the function will retrieve metadata for all available GAMBL sample IDs and then subset to the specified cohort or pathology.
The layout of the returned plot can also be further customized with <code>sort_by</code>. This parameter controls the order in which samples would appear. Similarly, <code>fill_by</code> allows the user to control on what factor the plot will be filled by.
In addition, the generated plot can also be returned as an interactive HTML rendering, allowing the user to easily hover over any of the points in the plot and get expanded information on each data point. To toggle this function, set the <code>interactive</code> parameter to TRUE.
If an interactive plot is generated, it is also possible to dictate what information should be available in the plotted data points. Default for this parameter is sample ID and cohort.
Sometimes it can also be useful to see how a subset of samples compares to another group; to do this one could call the function with a vector of additional sample IDs given to the <code>comparison_samples</code> parameter (see examples for more information).
lastly, the plot can also be configured with custom plot title and axis labels (<code>plot_title</code> and <code>y_axis_lab</code>). For more information, see examples and parameter descriptions.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Example 1 - using these_sample_ids parameter</span></span></span>
<span class="r-in"><span><span class="co">#subset on FL cases with QC metrics available and plot</span></span></span>
<span class="r-in"><span><span class="va">metadata</span> <span class="op">=</span> <span class="fu"><a href="get_gambl_metadata.html">get_gambl_metadata</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">kridel_fl</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">metadata</span>, <span class="va">pathology</span> <span class="op">==</span> <span class="st">"FL"</span>,</span></span>
<span class="r-in"><span>               <span class="va">cohort</span> <span class="op">==</span> <span class="st">"FL_Kridel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">kridel_fl_samples</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">kridel_fl</span>, <span class="va">sample_id</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fancy_qc_plot</span><span class="op">(</span>these_sample_ids <span class="op">=</span> <span class="va">kridel_fl_samples</span>,</span></span>
<span class="r-in"><span>              plot_data <span class="op">=</span> <span class="st">"AverageBaseQuality"</span>,</span></span>
<span class="r-in"><span>              y_axis_lab <span class="op">=</span> <span class="st">"Average Base Quality"</span>,</span></span>
<span class="r-in"><span>              plot_title <span class="op">=</span> <span class="st">"Average Base Quality For FL_Kridel"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> QC Metric successfully retreived for 56 samples out of a total of 56 samples in input sample table.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining, by = c("sample_id", "patient_id", "biopsy_id")</span>
<span class="r-plt img"><img src="fancy_qc_plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Example 2 - using already filtered metadata (these_samples_metadata)</span></span></span>
<span class="r-in"><span><span class="fu">fancy_qc_plot</span><span class="op">(</span>these_samples_metadata <span class="op">=</span> <span class="va">kridel_fl</span>,</span></span>
<span class="r-in"><span>              interactive <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>              labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cohort"</span>, <span class="st">"pathology"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              plot_data <span class="op">=</span> <span class="st">"AverageBaseQuality"</span>,</span></span>
<span class="r-in"><span>              y_axis_lab <span class="op">=</span> <span class="st">"Average Base Quality"</span>,</span></span>
<span class="r-in"><span>              plot_title <span class="op">=</span> <span class="st">"Average Base Quality For FL_Kridel"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> QC Metric successfully retreived for 56 samples out of a total of 56 samples in input sample table.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining, by = c("sample_id", "patient_id", "biopsy_id")</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>unable to open connection to X11 display ''</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in .External2(C_X11, paste0("png::", filename), g$width, g$height,     pointsize, d$gamma, d$colortype, d$maxcubesize, bg, bg, d$fonts,     res, 0L, 0L, "", 0, 0, d$family, optionSymbolFont(d$symbolfamily)):</span> unable to start device PNG</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Example 3 - using in-house metadata filtering options</span></span></span>
<span class="r-in"><span><span class="fu">fancy_qc_plot</span><span class="op">(</span>keep_cohort <span class="op">=</span> <span class="st">"FL_Kridel"</span>,</span></span>
<span class="r-in"><span>              keep_pathology <span class="op">=</span> <span class="st">"FL"</span>,</span></span>
<span class="r-in"><span>              plot_data <span class="op">=</span> <span class="st">"AverageBaseQuality"</span>,</span></span>
<span class="r-in"><span>              y_axis_lab <span class="op">=</span> <span class="st">"Average Base Quality"</span>,</span></span>
<span class="r-in"><span>              plot_title <span class="op">=</span> <span class="st">"Average Base Quality For FL_Kridel"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> /projects/nhl_meta_analysis_scratch/gambl/results_local/shared/gambl_genome_results.tsv</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> QC Metric successfully retreived for 56 samples out of a total of 56 samples in input sample table.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining, by = c("sample_id", "patient_id", "biopsy_id")</span>
<span class="r-plt img"><img src="fancy_qc_plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ryan Morin, Kostia Dreval, Adam Mattsson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

