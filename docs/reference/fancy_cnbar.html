<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Copy Number states barplot — fancy_cnbar • GAMBLR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Copy Number states barplot — fancy_cnbar"><meta property="og:description" content="Generate a bar plot visualizing sample-specific copy number states and affected bases for each CN segment."><meta property="og:image" content="https://github.com/morinlab/GAMBLR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMBLR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9500</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-memo-circle-info"></span>
     
    How To
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://morinlab.github.io/GAMBLR/#installation" class="external-link">Install</a>
    </li>
    <li>
      <a href="https://morinlab.github.io/GAMBLR/#running-gamblr-on-your-own-computer" class="external-link">Running GAMBLR On Your Own Computer</a>
    </li>
    <li>
      <a href="https://morinlab.github.io/GAMBLR/#contributing" class="external-link">Contribute</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-light fa-person-chalkboard"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ssm_tutorial.html">SSM</a>
    </li>
    <li>
      <a href="../articles/cn_sv_tutorial.html">CN &amp; SV</a>
    </li>
    <li>
      <a href="../articles/fancy_plots.html">Fancy Plots</a>
    </li>
    <li>
      <a href="../articles/utilities_tutorial.html">Utilities</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions &amp; Bundled Data
  </a>
</li>
<li>
  <a href="https://github.com/morinlab/GAMBLR">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Copy Number states barplot</h1>
    
    <div class="hidden name"><code>fancy_cnbar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate a bar plot visualizing sample-specific copy number states and affected bases for each CN segment.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fancy_cnbar</span><span class="op">(</span></span>
<span>  <span class="va">this_sample_id</span>,</span>
<span>  <span class="va">seq_data</span>,</span>
<span>  seq_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chrom_col <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  start_col <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  end_col <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cn_col <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">this_sample_id</span><span class="op">)</span>,</span>
<span>  plot_subtitle <span class="op">=</span></span>
<span>    <span class="st">"n CNV Segments (barplots, left y-axis), n Affected bases for each CN state"</span>,</span>
<span>  chr_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  include_cn2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  this_seq_type <span class="op">=</span> <span class="st">"genome"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>this_sample_id</dt>
<dd><p>Sample to be plotted.</p></dd>


<dt>seq_data</dt>
<dd><p>Optional parameter with copy number df already loaded into R.</p></dd>


<dt>seq_path</dt>
<dd><p>Optional parameter with path to external cn file.</p></dd>


<dt>chrom_col</dt>
<dd><p>Index of column with chromosome annotations (to be used with either maf_data or maf_path).</p></dd>


<dt>start_col</dt>
<dd><p>Index of column with copy number start coordinates (to be used with either maf_data or maf_path).</p></dd>


<dt>end_col</dt>
<dd><p>Index of column with copy number end coordinates (to be used with either maf_data or maf_path).</p></dd>


<dt>cn_col</dt>
<dd><p>Index of column holding copy number information (to be used with either maf_data or maf_path).</p></dd>


<dt>plot_title</dt>
<dd><p>Title of plot (default to sample ID).</p></dd>


<dt>plot_subtitle</dt>
<dd><p>Subtitle for created plot.</p></dd>


<dt>chr_select</dt>
<dd><p>Vector of chromosomes to be included in plot, defaults to autosomes.</p></dd>


<dt>cutoff</dt>
<dd><p>Set threshold for maximum CN state to be retrieved.</p></dd>


<dt>include_cn2</dt>
<dd><p>Optional boolean statement for including CN = 2 states in plot.</p></dd>


<dt>this_seq_type</dt>
<dd><p>Seq type for returned CN segments. One of "genome" (default) or "capture".</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A plot as a ggplot object (grob).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>fancy_cnbar</code> visualizes copy number (CN) states on sample-level. Similarly to other fancy_x_plots this function
accepts either a sample ID, for which the function will get copy number states with <a href="get_sample_cn_segments.html">get_sample_cn_segments</a>. The function
can also accept an already loaded seq file given to the <code>seq_data</code> parameter. It can also load a seq file with the <code>seq_path</code>
parameter. If the user calls either <code>seq_data</code> or <code>seq_path</code>, there are a collection of parameters available for specifying
the relevant columns in the given data frame (<code>chrom_col</code>, <code>starat_col</code>, <code>end_col</code>, <code>cn_col</code>). It is also possible to
restrict the returned plot to any given chromosome. This is done with the <code>chr_select</code> parameter (default is all autosomes).
For further control of the returned plot, it is also possible to set the threshold for maximum CN states to be returned (default is 15).
With <code>include_cn2</code> (Boolean) the user can control if CN segments = 2 should be added to the plot, default is TRUE.
The user can also control the annotations of the returned plot with <code>plot_title</code> and <code>plot_subtitle</code>. Lastly,
This function also computes the number of affected bases for each copy number state and plots these values on a secondary y-axis (right),
useful for overviewing the extent of each copy number state, in the context of the full genome.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Return a plot for one sample, with default parameters.</span></span></span>
<span class="r-in"><span><span class="fu">fancy_cnbar</span><span class="op">(</span>this_sample_id <span class="op">=</span> <span class="st">"HTMCP-01-06-00422-01A-01D"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> restricting to non-ICGC data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "missing:  /Users/rmorin/gambl_results/gambl/cnv_master-1.0/99-outputs/genome--projection/all--grch37.seg"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cannot find file locally. If working remotely, perhaps you forgot to load your config (see below) or sync your files?</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sys.setenv(R_CONFIG_ACTIVE = "remote")</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> '/Users/rmorin/gambl_results/gambl/cnv_master-1.0/99-outputs/genome--projection/all--grch37.seg' does not exist.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ryan Morin, Kostia Dreval, Adam Mattsson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

